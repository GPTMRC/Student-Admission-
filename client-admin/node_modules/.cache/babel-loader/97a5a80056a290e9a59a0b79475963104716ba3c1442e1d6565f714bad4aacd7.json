{"ast":null,"code":"const handleLogin = async e => {\n  e.preventDefault();\n  if (!loginData.email || !loginData.password) {\n    setError('Please fill in all fields');\n    return;\n  }\n  try {\n    setLoading(true);\n    setError('');\n\n    // 1. LOGIN USING SUPABASE AUTH\n    const {\n      data: authData,\n      error: authError\n    } = await supabase.auth.signInWithPassword({\n      email: loginData.email,\n      password: loginData.password\n    });\n    if (authError) throw authError;\n    const user = authData === null || authData === void 0 ? void 0 : authData.user;\n    if (!user) throw new Error('Authentication failed.');\n\n    // 2. CHECK IF THIS USER IS AN ADMIN (admin_users table)\n    const {\n      data: adminRow,\n      error: adminError\n    } = await supabase.from('admin_users') // <-- table we created\n    .select('*').eq('id', user.id).single();\n    if (adminError || !adminRow) {\n      // not admin → force logout\n      await supabase.auth.signOut();\n      throw new Error('Access denied. Admin account required.');\n    }\n\n    // 3. SUCCESS\n    console.log('✅ Admin Login Successful:', adminRow);\n    onLoginSuccess(adminRow); // pass admin data to parent\n  } catch (err) {\n    console.error('❌ Login error:', err);\n    setError(err.message || 'Invalid email or password');\n  } finally {\n    setLoading(false);\n  }\n};","map":{"version":3,"names":["handleLogin","e","preventDefault","loginData","email","password","setError","setLoading","data","authData","error","authError","supabase","auth","signInWithPassword","user","Error","adminRow","adminError","from","select","eq","id","single","signOut","console","log","onLoginSuccess","err","message"],"sources":["C:/Users/BaylonFam/student-admission-system/client-admin/src/components/AdminLogin.jsx"],"sourcesContent":["const handleLogin = async (e) => {\r\n  e.preventDefault();\r\n\r\n  if (!loginData.email || !loginData.password) {\r\n    setError('Please fill in all fields');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    // 1. LOGIN USING SUPABASE AUTH\r\n    const { data: authData, error: authError } = await supabase.auth.signInWithPassword({\r\n      email: loginData.email,\r\n      password: loginData.password,\r\n    });\r\n\r\n    if (authError) throw authError;\r\n\r\n    const user = authData?.user;\r\n    if (!user) throw new Error('Authentication failed.');\r\n\r\n    // 2. CHECK IF THIS USER IS AN ADMIN (admin_users table)\r\n    const { data: adminRow, error: adminError } = await supabase\r\n      .from('admin_users')     // <-- table we created\r\n      .select('*')\r\n      .eq('id', user.id)\r\n      .single();\r\n\r\n    if (adminError || !adminRow) {\r\n      // not admin → force logout\r\n      await supabase.auth.signOut();\r\n      throw new Error('Access denied. Admin account required.');\r\n    }\r\n\r\n    // 3. SUCCESS\r\n    console.log('✅ Admin Login Successful:', adminRow);\r\n    onLoginSuccess(adminRow); // pass admin data to parent\r\n\r\n  } catch (err) {\r\n    console.error('❌ Login error:', err);\r\n    setError(err.message || 'Invalid email or password');\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n"],"mappings":"AAAA,MAAMA,WAAW,GAAG,MAAOC,CAAC,IAAK;EAC/BA,CAAC,CAACC,cAAc,CAAC,CAAC;EAElB,IAAI,CAACC,SAAS,CAACC,KAAK,IAAI,CAACD,SAAS,CAACE,QAAQ,EAAE;IAC3CC,QAAQ,CAAC,2BAA2B,CAAC;IACrC;EACF;EAEA,IAAI;IACFC,UAAU,CAAC,IAAI,CAAC;IAChBD,QAAQ,CAAC,EAAE,CAAC;;IAEZ;IACA,MAAM;MAAEE,IAAI,EAAEC,QAAQ;MAAEC,KAAK,EAAEC;IAAU,CAAC,GAAG,MAAMC,QAAQ,CAACC,IAAI,CAACC,kBAAkB,CAAC;MAClFV,KAAK,EAAED,SAAS,CAACC,KAAK;MACtBC,QAAQ,EAAEF,SAAS,CAACE;IACtB,CAAC,CAAC;IAEF,IAAIM,SAAS,EAAE,MAAMA,SAAS;IAE9B,MAAMI,IAAI,GAAGN,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEM,IAAI;IAC3B,IAAI,CAACA,IAAI,EAAE,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;;IAEpD;IACA,MAAM;MAAER,IAAI,EAAES,QAAQ;MAAEP,KAAK,EAAEQ;IAAW,CAAC,GAAG,MAAMN,QAAQ,CACzDO,IAAI,CAAC,aAAa,CAAC,CAAK;IAAA,CACxBC,MAAM,CAAC,GAAG,CAAC,CACXC,EAAE,CAAC,IAAI,EAAEN,IAAI,CAACO,EAAE,CAAC,CACjBC,MAAM,CAAC,CAAC;IAEX,IAAIL,UAAU,IAAI,CAACD,QAAQ,EAAE;MAC3B;MACA,MAAML,QAAQ,CAACC,IAAI,CAACW,OAAO,CAAC,CAAC;MAC7B,MAAM,IAAIR,KAAK,CAAC,wCAAwC,CAAC;IAC3D;;IAEA;IACAS,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAET,QAAQ,CAAC;IAClDU,cAAc,CAACV,QAAQ,CAAC,CAAC,CAAC;EAE5B,CAAC,CAAC,OAAOW,GAAG,EAAE;IACZH,OAAO,CAACf,KAAK,CAAC,gBAAgB,EAAEkB,GAAG,CAAC;IACpCtB,QAAQ,CAACsB,GAAG,CAACC,OAAO,IAAI,2BAA2B,CAAC;EACtD,CAAC,SAAS;IACRtB,UAAU,CAAC,KAAK,CAAC;EACnB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}